<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Now Watching | Dareloom Hub</title>
  
  <!-- SEO + Fallback Meta -->
  <meta name="robots" content="index, follow" />
  <meta name="description" content="Watch high-quality streaming content safely on Dareloom Hub." />
  <link rel="canonical" href="https://dareloom.fun/watch.html" />

  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100%;
      width: 100%;
      background-color: #000;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      font-family: Arial, sans-serif;
      color: #fff;
    }

    iframe {
      width: 100%;
      height: 100%;
      border: none;
      position: absolute;
      top: 0;
      left: 0;
      background: #000;
    }

    .fallback {
      text-align: center;
      padding: 20px;
      max-width: 90%;
    }

    .fallback h2 {
      color: #ff4d4d;
      font-size: 1.4em;
      margin-bottom: 10px;
    }

    .fallback p {
      color: #bbb;
      font-size: 0.9em;
    }

    @media (max-width: 600px) {
      .fallback h2 { font-size: 1.1em; }
      .fallback p { font-size: 0.8em; }
    }
  </style>
</head>
<body>
  <script>
    (function() {
      const params = new URLSearchParams(window.location.search);
      let videoUrl = params.get("url");

      // ‚úÖ Safety: Validate and auto-correct streamtape links if needed
      if (videoUrl) {
        videoUrl = decodeURIComponent(videoUrl.trim());
        if (videoUrl.includes("streamtape.com/v/")) {
          const id = videoUrl.split("/v/")[1]?.split("/")[0];
          if (id) videoUrl = `https://streamtape.com/e/${id}/`;
        } else if (videoUrl.includes("stape.fun/v/")) {
          const id = videoUrl.split("/v/")[1]?.split("/")[0];
          if (id) videoUrl = `https://stape.fun/e/${id}/`;
        }
      }

      // ‚úÖ Display iframe if valid embed link
      if (videoUrl && (videoUrl.includes("streamtape.com/e/") || videoUrl.includes("stape.fun/e/"))) {
        document.body.innerHTML = `
          <iframe 
            src="${videoUrl}" 
            allowfullscreen 
            allow="autoplay; fullscreen; encrypted-media; picture-in-picture">
          </iframe>
        `;
      } else {
        // ‚ö†Ô∏è Fallback safe message
        document.body.innerHTML = `
          <div class="fallback">
            <h2>‚ö†Ô∏è No valid video link found.</h2>
            <p>Please return to Dareloom Hub and try another link.</p>
          </div>
        `;
        console.warn("Invalid or missing video URL:", videoUrl);
      }

      // üß© Optional: auto-set canonical dynamically
      const canonical = document.querySelector('link[rel="canonical"]');
      if (canonical && videoUrl) canonical.href = location.origin + location.pathname + "?url=" + encodeURIComponent(videoUrl);
    })();
  </script>
</body>
</html>
